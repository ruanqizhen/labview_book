# 面向对象编程

![](cover/oop.png)

图中的帅哥正在面向他的对象编程......

如果用一句话解释为什么要有“面向对象编程”（Object-Oriented Programming，OOP），那就是：面向对象编程可以有效地把大程序拆分成小模块，帮我们创建一个既灵活又稳定的系统：灵活体现在可以随时添加新的功能；稳定性体现在它在添加新功能时，不需要改动已有的程序模块。

现实中需要编程解决的问题越来越复杂，规模越来越大。传统的 LabVIEW 面向数据流编程虽然可以通过子 VI 很好地实现“功能上的模块化”，但在处理大型项目时，传统的“簇（Cluster）+ 子 VI”模式往往会暴露出短板：一旦核心数据结构发生改变，所有相关联的代码连线都需要跟着修改（牵一发而动全身），导致代码极其难以扩展和管理。为了解决这种数据耦合和状态管理的难题，程序员们最终都会借助面向对象编程的思想。

那么，什么时候应该使用面向对象编程呢？决定是否采用 OOP 的核心标准是项目的复杂度需求和团队规模：
1. 硬件/需求的多样性： 如果程序需要控制多种不同型号的同类仪器（例如几款不同的示波器），或者未来需要不断接入新的测试产品，利用 OOP 的动态分派（多态）可以轻松实现硬件抽象和无缝切换。
2. 数据状态的复杂性： 当程序中有大量复杂的数据结构，且这些数据需要被严格保护、避免在程序框图中被随意篡改时，OOP 的“类封装”是最佳选择。
3. 团队协作开发： 在多人合作开发中，OOP 定义了清晰的类接口（API），各个开发者只需关注自己负责的类，极大地减少了代码冲突。

当然，设计和编写面向对象的程序存在一定的学习曲线，前期也会消耗更多的架构设计时间。如果只是一个极其简单的单次数据采集工具，传统的编程方法完全足够；但对于需要长期维护、迭代的平台型软件，OOP 是不可或缺的利器。
